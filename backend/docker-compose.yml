services:
  web:
    build: .
    ports:
      - "7097:7097"
    volumes:
      - .:/app
    working_dir: /app
    command:
      - python
      - api.py
    env_file:
      - .env
    environment:
      - NVIDIA_VISIBLE_DEVICES=all
      - NVIDIA_DRIVER_CAPABILITIES=compute,utility
    # Request all GPUs (requires NVIDIA Container Toolkit on the host)
    gpus: all
    ipc: host
    ulimits:
      memlock: -1
      stack: 67108864
